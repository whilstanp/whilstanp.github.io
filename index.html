<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=fjalla+one" rel="stylesheet">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.min.css" />
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
    <!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@[VERSION]/dist/L.Control.Locate.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@[VERSION]/dist/L.Control.Locate.min.js" charset="utf-8"></script>-->
    <title>Progressive Web Apps</title>
    <style>
        #map {
            width: 400px;
            height: 524px;
        }
        /*@media only screen and (min-width: 600px) and (min-height: 480px){
            #map {
                width: 848px;
                height: 480px;
            }
        }*/
        @media only screen and (min-width: 800px) and (min-height: 720px){
            #map {
                width: 1280px;
                height: 720px;
            }
        }
        @media only screen and (min-width: 1000px) and (min-height: 900px){
            #map {
                width: 1600px;
                height: 900px;
            }
        }
        @media (orientation: landscape){
            #map {
                width: 668px;
                height: 268px;
            }
        }
        .demo-layout-transparent {
            background: #008B8B center / cover;
        }
        .mdl-layout-title{
            color: black;
        }
	.mdl-layout__content{
	    background: #AFEEEE no-repeat;
	}
    </style>
    <script type="text/javascript">
        /*var lc = L.control.locate().addTo(map);
        lc.start();
        map.addControl(L.control.locate({
        locateOptions: {
               enableHighAccuracy: true
        }}));*/
        function init() {
            /*var mapOSM = L.map('map').setView(lc, 12);
            var mapOSM = L.map('map').fitWorld();
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z},{x},{y}.png', {
                        attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                        maxZoom: 18 }).addTo(mapOSM);
            map.locate({setView: true, maxZoom: 18});
            function onLocationFound(e) {
	            var radius = e.accuracy;
	            L.marker(e.latlng).addTo(mapOSM).bindPopup("You are within " + radius + " meters from this point").openPopup();
                L.circle(e.latlng, radius).addTo(mapOSM);}
            map.on('locationfound', onLocationFound);
            function onLocationError(e) {
	            alert(e.message);
            }
            map.on('locationerror', onLocationError);
            L.marker(lc).addTo(mapOSM).bindPopup('A pretty CSS3 popup.<br> Easily customizable.').openPopup();*/
        }
    </script>
    <link rel="manifest" href="/manifest.json">
    <script src="/script.js"></script>
    <script src="/src/js/app.js"></script>
</head>
<body onload="javascript:init();">
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header mdl-layout__header--waterfall portfolio-header">
        <div class="mdl-layout__header-row portfolio-logo-row">
            <span class="mdl-layout__title">
                <span class="mdl-layout__title">Kodepos RT/RW OpenStreetMap</span>
            </span>
        </div>
    </header>
    <div class="mdl-layout__drawer">
        <span class="mdl-layout-title">krosm menu</span>
        <nav class="mdl-navigation">
            <a class="mdl-navigation__link" href="">directions</a>
            <a class="mdl-navigation__link" href="">pinpoint slideshows</a>
	    <a class="mdl-navigation__link" href="">share or embed map</a>
        </nav>
    </div>
    <main class="mdl-layout__content">
    <div class="mdl-grid portfolio-max-width">
        <div>
            <div id="map"></div>
        </div>
	<p>
      		latitude: <span id="latitude"></span>&deg;<br />
      		longitude: <span id="longitude"></span>&deg;
    	</p>
	<script>
	if ('geolocation' in navigator) {
		console.log('geolocation available');
		navigator.geolocation.getCurrentPosition(position => {
			lat = position.coords.latitude;
			lon = position.coords.longitude;
			console.log(lat, lon);
			document.getElementById('latitude').textContent = lat;
			document.getElementById('longitude').textContent = lon;
			const mymap = L.map('map').setView([lat, lon], 15);
			const attribution = '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';
			const tileUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
			const tiles = L.tileLayer(tileUrl, { attribution });
			tiles.addTo(mymap);
			const marker = L.marker([lat, lon]).addTo(mymap);});
      		} else {
        	console.log('geolocation not available');
      		}
	</script>
    </div>
    <footer id="ftr" class="mdl-mega-footer">
        <div class="mdl-mega-footer__middle-section">
            <div class="mdl-logo">©2019 Adrian Evan. All rights reserved</div>
        </div>
    </footer>
    </main>
</div>
</body>
</html>
