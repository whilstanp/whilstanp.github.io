<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=fjalla+one" rel="stylesheet">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.min.css" />
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-responsive-popup@0.6.4/leaflet.responsive.popup.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-responsive-popup@0.6.4/leaflet.responsive.popup.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-responsive-popup@0.6.4/leaflet.responsive.popup.rtl.css" />
    <script src="https://unpkg.com/esri-leaflet"></script>
    <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder/dist/esri-leaflet-geocoder.css">
    <script src="https://unpkg.com/esri-leaflet-geocoder"></script>
    <title>Progressive Web Apps</title>
    <style>
        #map {
            width: 400px;
            height: 524px;
        }
        @media only screen and (min-width: 800px) and (min-height: 720px){
            #map {
                width: 1280px;
                height: 720px;
            }
        }
        @media only screen and (min-width: 1000px) and (min-height: 900px){
            #map {
                width: 1600px;
                height: 900px;
            }
        }
        @media (orientation: landscape){
            #map {
                width: 668px;
                height: 268px;
            }
        }
        .demo-layout-transparent {
            background: #008B8B center / cover;
        }
        .mdl-layout-title{
            color: black;
        }
	.mdl-layout__content{
	    background: #AFEEEE no-repeat;
	}
    </style>
    <link rel="manifest" href="/manifest.json">
    <script src="/script.js"></script>
    <script src="/src/js/app.js"></script>
</head>
<body>
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header mdl-layout__header--waterfall portfolio-header">
        <div class="mdl-layout__header-row portfolio-logo-row">
            <span class="mdl-layout__title">
                <span class="mdl-layout__title">Kodepos RT/RW OpenStreetMap</span>
            </span>
        </div>
    </header>
    <div class="mdl-layout__drawer">
        <span class="mdl-layout-title">krosm menu</span>
        <nav class="mdl-navigation">
            <a class="mdl-navigation__link" href="">directions</a>
            <a class="mdl-navigation__link" href="">pinpoint slideshows</a>
	    <a class="mdl-navigation__link" href="">share or embed map</a>
        </nav>
    </div>
    <main class="mdl-layout__content">
    <div class="mdl-grid portfolio-max-width">
	<p hidden>
        latitude: <span id="latitude"></span>&deg;<br />
        longitude: <span id="longitude"></span>&deg;
	</p>
        <div>
            <div id="map"></div>
        </div>
	<script>
	if ('geolocation' in navigator) {
		navigator.geolocation.getCurrentPosition(position => {
			lat = position.coords.latitude;
			lon = position.coords.longitude;
			document.getElementById('latitude').textContent = lat;
			document.getElementById('longitude').textContent = lon;
			const mymap = L.map('map').setView([lat, lon], 15);
			const attribution = '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';
			const tileUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
			const tiles = L.tileLayer(tileUrl, { attribution });
			tiles.addTo(mymap);
    			var searchControl = L.esri.Geocoding.geosearch().addTo(mymap);
    			var results = L.layerGroup().addTo(mymap);
			var geocodeService = L.esri.Geocoding.geocodeService();
    			searchControl.on("results", function(data) {
                		results.clearLayers();
                		for (var i = data.results.length - 1; i >= 0; i--) {
                    			results.addLayer(L.marker(data.results[i].latlng).bindPopup(data.results[i].properties.Match_addr + '\n'));
                		}
            		});
			const popup = L.responsivePopup({ autoPanPadding: [10,10] }).setContent('current location');
			const marker = L.marker([lat, lon]).addTo(mymap).bindPopup(popup).openPopup();});
      		} else {}
	</script>
    </div>
    <footer id="ftr" class="mdl-mega-footer">
        <div class="mdl-mega-footer__middle-section">
            <div class="mdl-logo">Â©2019 Adrian Evan. All rights reserved</div>
        </div>
    </footer>
    </main>
</div>
</body>
</html>
